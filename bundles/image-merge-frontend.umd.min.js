!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@fortawesome/free-regular-svg-icons"),require("@fortawesome/angular-fontawesome"),require("@fortawesome/free-solid-svg-icons")):"function"==typeof define&&define.amd?define("image-merge-frontend",["exports","@angular/core","rxjs","rxjs/operators","@angular/common","@fortawesome/free-regular-svg-icons","@fortawesome/angular-fontawesome","@fortawesome/free-solid-svg-icons"],t):t((e=e||self)["image-merge-frontend"]={},e.ng.core,e.rxjs,e.rxjs.operators,e.ng.common,e.freeRegularSvgIcons,e.angularFontawesome,e.freeSolidSvgIcons)}(this,(function(e,t,r,n,i,o,a,s){"use strict";var l=new t.InjectionToken("IMAGE_MERGE_FRONTEND_CONFIG_TOKEN"),g=function(){function e(e){void 0===e&&(e={}),this.config=e,this.setConfig(e)}return e.prototype.setConfig=function(e){this.config=e,this.heightWidthRatio=this.getPlainSize().y/this.getPlainSize().x},e.prototype.getPlainSize=function(){return this.config.plainSize||{x:600,y:800}},e.prototype.getHeightWidthRatio=function(){return this.heightWidthRatio||this.getPlainSize().y/this.getPlainSize().x},e}();g.decorators=[{type:t.Injectable}],g.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:[l]}]}]};var u=function(){function e(e,n){this.config=e,this.wrapperElement=n,this.resizeThrottled$=new r.Subject,this.moveTo="center",this.ratioChange=new t.EventEmitter,this.currentMaxHeightChange=new t.EventEmitter,this.subscriptions=[]}return e.prototype.ngOnInit=function(){this.subscriptions.push(this.resizeThrottled$.pipe(n.throttleTime(80),n.distinctUntilChanged()).subscribe(this.getCalSizeCallback().bind(this)))},e.prototype.ngAfterViewInit=function(){this.getCalSizeCallback()()},e.prototype.getCalSizeCallback=function(){var e=this;return function(){return setTimeout(e.calcSize.bind(e))}},e.prototype.calcSize=function(e){void 0===e&&(e=0);var t=this.config.getHeightWidthRatio(),r=this.maxHeight||this.config.getPlainSize().y,n=(e=e||this.wrapperElement.nativeElement.offsetWidth)*t;n>r&&(e=(n=r)*(1/t)),this.fillerHeight=n,this.fillerWidth=e,this.ratio=e/this.config.getPlainSize().x,this.ratioChange.emit(this.ratio),this.currentMaxHeightChange.emit(this.fillerHeight)},e.prototype.ngOnDestroy=function(){this.subscriptions.forEach((function(e){e.unsubscribe()}))},e.prototype.getMergeStyle=function(){return{height:this.fillerHeight+"px",width:this.fillerWidth+"px"}},e}();u.decorators=[{type:t.Component,args:[{selector:"lib-image-merge-frontend",template:'<ng-container>\n    <div class="image-merge-frontend" [ngStyle]="this.getMergeStyle()" #imageMergeFrontendFiller>\n        <lib-image-layer [layerImage]="layerImage" [ratio]="ratio"></lib-image-layer>\n    </div>\n</ng-container>\n',styles:[":host{display:flex;height:100%;justify-content:center;left:0;width:100%}.image-merge-frontend{position:relative;width:100%}"]}]}],u.ctorParameters=function(){return[{type:g},{type:t.ElementRef}]},u.propDecorators={resizeThrottled$:[{type:t.Input}],layerImage:[{type:t.Input}],maxHeight:[{type:t.Input}],moveTo:[{type:t.Input},{type:t.HostBinding,args:["style.justify-content"]}],ratioChange:[{type:t.Output}],currentMaxHeightChange:[{type:t.Output}],fillerElement:[{type:t.ViewChild,args:["imageMergeFrontendFiller"]}]};var c=function(){function e(e){this.config=e,this.parentLayerOffset={x:0,y:0}}return e.prototype.doNotSort=function(){return 0},e.prototype.ngOnChanges=function(e){if(e.layerImage&&e.layerImage.currentValue!==e.layerImage.previousValue){var t=e.layerImage.currentValue;t.variants&&void 0===t.currentVariant&&(t.currentVariant=0)}},e.prototype.isNumeric=function(e){return"number"==typeof e},e}();c.decorators=[{type:t.Component,args:[{selector:"lib-image-layer",template:'<div class="layer-image" *ngIf="layerImage">\n    <lib-image-layer\n            *ngFor="let subLayerImage of (layerImage.images | keyvalue : doNotSort)"\n            [layerImage]="subLayerImage.value"\n            [ratio]="ratio"\n            [parentLayerOffset]="layerImage.subLayerOffset || {x: 0, y: 0}"\n    ></lib-image-layer>\n\n\n    <img class="layer-image__image"\n         libHideImageOnLoad\n         *ngIf="layerImage.url || (isNumeric(layerImage.currentVariant) && layerImage.variants && layerImage.variants[layerImage.currentVariant])"\n         [src]="layerImage.url || layerImage.variants[layerImage.currentVariant].url"\n         alt="image"\n         [ngStyle]="{\n                position: \'absolute\',\n                top: (layerImage.offset.y * ratio + parentLayerOffset.y * ratio) + \'px\',\n                left: (layerImage.offset.x * ratio + parentLayerOffset.x * ratio) + \'px\',\n                height: layerImage.size.y * ratio + \'px\',\n                width: layerImage.size.x * ratio + \'px\'\n              }"\n    />\n</div>\n',styles:[".layer-image{bottom:0;left:0;position:absolute;right:0;top:0}.layer-image,.layer-image__image{pointer-events:none}"]}]}],c.ctorParameters=function(){return[{type:g}]},c.propDecorators={layerImage:[{type:t.Input}],parentLayerOffset:[{type:t.Input}],ratio:[{type:t.Input}]};var p=function(e){e.addIconPacks(s.fas,o.far)};p.decorators=[{type:t.NgModule,args:[{declarations:[],imports:[a.FontAwesomeModule],exports:[a.FontAwesomeModule]}]}],p.ctorParameters=function(){return[{type:a.FaIconLibrary}]};var f=function(){function e(e,t){this.elRef=e,this.renderer=t}return e.prototype.ngOnInit=function(){this.elRef.nativeElement.addEventListener("load",this.showElement.bind(this))},e.prototype.ngOnDestroy=function(){this.elRef.nativeElement.removeEventListener("load",this.showElement)},e.prototype.ngOnChanges=function(e){e.src&&e.src.currentValue!==e.src.previousValue&&(this.renderer.setAttribute(this.elRef.nativeElement,"src",e.src.currentValue),this.elRef.nativeElement.style.display="none")},e.prototype.showElement=function(){this.elRef.nativeElement.style.display="block"},e}();f.decorators=[{type:t.Directive,args:[{selector:"[libHideImageOnLoad]"}]}],f.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2}]},f.propDecorators={src:[{type:t.Input}]};var m={},y=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:l,useValue:t}]}},e}();y.decorators=[{type:t.NgModule,args:[{declarations:[u,c,f],imports:[i.CommonModule,p],providers:[g,{provide:l,useValue:m}],exports:[u]}]}],e.ConfigService=g,e.IMAGE_MERGE_FRONTEND_CONFIG_TOKEN=l,e.ImageMergeFrontendComponent=u,e.ImageMergeFrontendModule=y,e.ɵ0=m,e.ɵa=c,e.ɵb=f,e.ɵc=p,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=image-merge-frontend.umd.min.js.map